<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë ˆë²¨ ëª©ë¡ - FP List</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .fps-badge {
            min-width: 45px;
            text-align: center;
        }
        .rating-badge {
            min-width: 60px;
            font-weight: bold;
        }
        .table-responsive {
            border-radius: 0.375rem;
        }
        .level-name {
            font-weight: 600;
        }
        .comment-text {
            font-style: italic;
            color: #6c757d;
        }
        
        /* í…Œì´ë¸” ì¼ê´€ì„±ì„ ìœ„í•œ ì¶”ê°€ ìŠ¤íƒ€ì¼ */
        .consistent-table td {
            vertical-align: middle;
            padding: 12px 8px;
            min-height: 60px;
        }
        
        .level-name-cell {
            max-width: 180px;
            min-width: 150px;
        }
        
        .level-name-text {
            display: block;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 180px;
        }
        
        .level-id {
            display: block;
            margin-top: 2px;
            white-space: nowrap;
        }
        
        .comment-cell {
            max-width: 200px;
            min-width: 120px;
        }
        
        .comment-text {
            display: block;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 180px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 2px 4px;
            border-radius: 4px;
        }
        
        .comment-text:hover {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
        }
        
        .comment-expanded {
            white-space: normal !important;
            overflow: visible !important;
            text-overflow: unset !important;
            max-width: none !important;
            background-color: #e7f3ff;
            border: 1px solid #0066cc;
            padding: 6px 8px;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .row-expanded {
            background-color: #f8f9fa;
        }
        
        .link-cell {
            min-width: 80px;
            text-align: center;
        }
        
        .video-btn {
            white-space: nowrap;
            font-size: 0.875rem;
            padding: 0.25rem 0.5rem;
            min-width: 70px;
        }
        
        .badge-cell {
            text-align: center;
            min-width: 50px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">FP List</a>
            <div class="navbar-nav">
                <a class="nav-link" href="/">í™ˆ</a>
                <a class="nav-link active" href="/levels">ë ˆë²¨ ëª©ë¡</a>
                <a class="nav-link" href="/welcome">ì†Œê°œ</a>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- í—¤ë” ì„¹ì…˜ -->
        <div class="row mb-4">
            <div class="col-md-8">
                <h2>í”„ë ˆì„ í¼í™íŠ¸ ë ˆë²¨ ëª©ë¡</h2>
                <p class="text-muted">
                    ì´ <span th:text="${totalCount}">0</span>ê°œ ë ˆë²¨ ì¤‘ 
                    <span th:text="${filteredCount}">0</span>ê°œ í‘œì‹œ ì¤‘
                </p>
            </div>
            <div class="col-md-4 text-end">
                <small class="text-muted">ë‚œì´ë„(Rating) ë†’ì€ ìˆœìœ¼ë¡œ ì •ë ¬</small>
                <br>
                <small class="text-muted fst-italic">
                    <strong>Rating ê³„ì‚°ì‹:</strong><br>
                    60fps í”„í¼í™ + (120fps í”„í¼í™ Ã— 2) + (240fps í”„í¼í™ Ã— 4)
                </small>
            </div>
        </div>

        <!-- í•„í„° ë° ê²€ìƒ‰ ì„¹ì…˜ -->
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <h6 class="card-title">ğŸ” ë ˆë²¨ ê²€ìƒ‰</h6>
                        <form method="get" action="/levels">
                            <div class="input-group">
                                <input type="text" class="form-control" name="search" 
                                    th:value="${currentSearch}" placeholder="ë ˆë²¨ëª… ê²€ìƒ‰...">
                                <button class="btn btn-outline-primary" type="submit">ê²€ìƒ‰</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        <h6 class="card-title">ğŸ“‚ ìƒíƒœë³„ í•„í„°</h6>
                        <div class="btn-group w-100" role="group">
                            <a href="/levels" class="btn btn-outline-secondary" 
                            th:classappend="${currentStatus == null} ? 'active' : ''">ì „ì²´</a>
                            <a href="/levels?status=R" class="btn btn-outline-success"
                            th:classappend="${currentStatus == 'R'} ? 'active' : ''">R</a>
                            <a href="/levels?status=V" class="btn btn-outline-info"
                            th:classappend="${currentStatus == 'V'} ? 'active' : ''">V</a>
                            <a href="/levels?status=C" class="btn btn-outline-warning"
                            th:classappend="${currentStatus == 'C'} ? 'active' : ''">C</a>
                            <a href="/levels?status=U" class="btn btn-outline-secondary"
                            th:classappend="${currentStatus == 'U'} ? 'active' : ''">U</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

                <!-- ë ˆë²¨ ëª©ë¡ í…Œì´ë¸” -->
        <div class="table-responsive">
            <table class="table table-hover consistent-table">
                <thead class="table-dark">
                    <tr>
                        <th style="width: 180px; white-space: nowrap;">ë ˆë²¨ëª…</th>
                        <th style="width: 70px; white-space: nowrap;">ë‚œì´ë„</th>
                        <th style="width: 60px; white-space: nowrap;">ìƒíƒœ</th>
                        <th style="width: 110px; white-space: nowrap;">60fps í”„í¼í™</th>
                        <th style="width: 110px; white-space: nowrap;">120fps í”„í¼í™</th>
                        <th style="width: 110px; white-space: nowrap;">240fps í”„í¼í™</th>
                        <th style="width: 200px; white-space: nowrap;">ì½”ë©˜íŠ¸</th>
                        <th style="width: 80px; white-space: nowrap;">ë§í¬</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="level : ${levels}">
                        <td class="level-name-cell">
                            <span class="level-name level-name-text" th:text="${level.levelName}" 
                                  th:title="${level.levelName}">Level Name</span>
                            <small class="text-muted level-id" th:text="'ID: ' + ${level.levelId}">ID: 12345</small>
                        </td>
                        <td class="badge-cell">
                            <span class="badge rating-badge" 
                                  th:classappend="${level.rating >= 300} ? 'bg-danger' : 
                                                 (${level.rating >= 200} ? 'bg-warning' : 
                                                 (${level.rating >= 100} ? 'bg-info' : 'bg-success'))"
                                  th:text="${level.rating}">380</span>
                        </td>
                        <td class="badge-cell">
                            <span class="badge fps-badge" 
                                  th:classappend="${level.status.code == 'R'} ? 'bg-success' : 
                                                 (${level.status.code == 'V'} ? 'bg-info' : 
                                                 (${level.status.code == 'C'} ? 'bg-warning' : 'bg-secondary'))"
                                  th:text="${level.status.code}"
                                  th:title="${level.status.description}">R</span>
                        </td>
                        <td class="badge-cell">
                            <span class="badge fps-badge bg-danger" th:text="${level.fpsData.fps60}">212</span>
                        </td>
                        <td class="badge-cell">
                            <span class="badge fps-badge bg-warning" th:text="${level.fpsData.fps120}">78</span>
                        </td>
                        <td class="badge-cell">
                            <span class="badge fps-badge bg-success" th:text="${level.fpsData.fps240}">3</span>
                        </td>
                        <td class="comment-cell">
                            <small class="comment-text" 
                                   th:text="${level.comment ?: '-'}" 
                                   th:title="'í´ë¦­í•˜ì—¬ ì „ì²´ ë³´ê¸°: ' + ${level.comment}"
                                   th:data-comment="${level.comment}"
                                   onclick="toggleComment(this)">Comment</small>
                        </td>
                        <td class="link-cell">
                            <a th:if="${level.levelLink != null and !level.levelLink.isEmpty()}" 
                               th:href="${level.levelLink}" target="_blank" 
                               class="btn btn-sm btn-outline-primary video-btn">
                                ğŸ“º ì˜ìƒ
                            </a>
                            <span th:unless="${level.levelLink != null and !level.levelLink.isEmpty()}" 
                                  class="text-muted">-</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- ì„¤ëª… ì„¹ì…˜ -->
        <div class="row mt-4">
            <div class="col-md-12">
                <div class="alert alert-info">
                    <h6>ğŸ’¡ í‘œ ì„¤ëª…</h6>
                    <ul class="mb-0">
                        <li><strong>í”„í¼í™ êµ¬ê°„ ê°œìˆ˜</strong>: í•´ë‹¹ FPSì—ì„œ ë‹¨ 1í”„ë ˆì„ë§Œ ìƒì¡´í•˜ëŠ” ì í”„ êµ¬ê°„ì˜ ê°œìˆ˜</li>
                        <li><strong>FPSë³„ ì°¨ì´</strong>: 60fps > 120fps > 240fps ìˆœìœ¼ë¡œ í”„í¼í™ êµ¬ê°„ì´ ì¤„ì–´ë“­ë‹ˆë‹¤</li>
                        <li><strong>ìƒíƒœ ì½”ë“œ</strong>: R(Rated), V(Verified), C(Challenge), U(Unverified)</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        function toggleComment(element) {
            // ë¹ˆ ì½”ë©˜íŠ¸ë‚˜ '-'ì¸ ê²½ìš° ë™ì‘í•˜ì§€ ì•ŠìŒ
            const comment = element.getAttribute('data-comment');
            if (!comment || comment === '' || comment === '-') {
                return;
            }
            
            // í˜„ì¬ í–‰ ì°¾ê¸°
            const row = element.closest('tr');
            
            // í† ê¸€ ìƒíƒœ í™•ì¸
            if (element.classList.contains('comment-expanded')) {
                // ì¶•ì†Œ ìƒíƒœë¡œ ë³€ê²½
                element.classList.remove('comment-expanded');
                row.classList.remove('row-expanded');
                
                // ì›ë˜ ì˜ë¦° í…ìŠ¤íŠ¸ë¡œ ë³µì›
                const originalText = comment.length > 30 ? comment.substring(0, 30) + '...' : comment;
                element.textContent = originalText;
                element.title = 'í´ë¦­í•˜ì—¬ ì „ì²´ ë³´ê¸°: ' + comment;
            } else {
                // í™•ì¥ ìƒíƒœë¡œ ë³€ê²½
                element.classList.add('comment-expanded');
                row.classList.add('row-expanded');
                
                // ì „ì²´ í…ìŠ¤íŠ¸ í‘œì‹œ
                element.textContent = comment;
                element.title = 'í´ë¦­í•˜ì—¬ ì¶•ì†Œí•˜ê¸°';
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸´ ì½”ë©˜íŠ¸ë“¤ì„ ìë™ìœ¼ë¡œ ì˜ë¼ì„œ í‘œì‹œ
        document.addEventListener('DOMContentLoaded', function() {
            const commentElements = document.querySelectorAll('.comment-text');
            commentElements.forEach(function(element) {
                const comment = element.getAttribute('data-comment');
                if (comment && comment !== '' && comment !== '-') {
                    if (comment.length > 30) {
                        const truncatedText = comment.substring(0, 30) + '...';
                        element.textContent = truncatedText;
                    }
                }
            });
        });
    </script>
</body>
</html> 